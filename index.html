<script type="text/javascript">
<!--

window.moveTo(screen.width/2-150, screen.height/2-150);
window.resizeTo(400, 300);
 
// CDO.Message オブジェクト生成
var cdoMsg = new ActiveXObject("CDO.Message");

// CDO オブジェクトコンフィグ用名前空間
var schemas = "http://schemas.microsoft.com/cdo/configuration/";

// 送信時にネットワークを利用するための設定（ 2 ： cdoSendUsingPort ）
cdoMsg.Configuration.Fields.Item(schemas+"sendusing") = 2;

// SMTPサーバ設定
cdoMsg.Configuration.Fields.Item(schemas+"smtpserver") = "★smtp-server★";
// SMTPポート設定
cdoMsg.Configuration.Fields.Item(schemas+"smtpserverport") = 25;
 
// Basic認証設定
cdoMsg.Configuration.Fields.Item(schemas + "smtpauthenticate") = true;
// 認証ユーザ設定
cdoMsg.Configuration.Fields.Item(schemas + "sendusername") = "★username★";
// 認証パスワード設定
cdoMsg.Configuration.Fields.Item(schemas + "sendpassword") = "★password★";
// SSL使用設定
cdoMsg.Configuration.Fields.Item(schemas + "smtpusessl") = true;
 
// コンフィグ更新
cdoMsg.Configuration.Fields.Update();

// 送信元アドレス設定
cdoMsg.From     = "★from-address★";
 
function send(){

    // 送信先アドレス設定
    cdoMsg.To       = document.getElementById("mail_to").value;

    // タイトル設定
    cdoMsg.Subject  = document.getElementById("mail_subject").value;

    // 本文設定
    cdoMsg.TextBody = document.getElementById("mail_textbody").value;
 
    try {

        // メール送信
        cdoMsg.Send();

    } catch(e) {

        // エラー発生時の処理
        alert(e.message);
    }
}
//-->
</script>

<div style="background-color : #CCC;">
 
<table>
    <tr>
        <td>宛先</td>
        <td><input id="mail_to" type="text" placeholder="xxx@yyy.com"></td>
    </tr>
 
    <tr>
        <td>件名</td>
        <td><input id="mail_subject" type="text" placeholder="タイトル"></td>
    </tr>
 
    <tr>
        <td>本文</td>
        <td><textarea id="mail_textbody" cols=35 rows=10 placeholder="本文"></textarea></td>
    </tr>
</table>

<input id=send_button  type="button" value="送信" onClick="send()">

</div>
